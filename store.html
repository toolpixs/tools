<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Shop at Toolpix Store for a wide range of digital products including software, e-books, AI tools, and productivity utilities. Enjoy the best deals and discounts with secure, instant access—no registration required.">
  <meta name="keywords" content="digital products, software, e-books, AI tools, productivity tools, digital store, discounts, deals, Toolpix, web utilities, secure shopping">
  <meta name="robots" content="index, follow">
  <meta name="author" content="Time Load Company">
  <title>Toolpix Store - Buy Premium Digital Products & Tools</title>

  <!-- Canonical URL -->
  <link rel="canonical" href="https://toolpix.netlify.app/store">

  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Toolpix Store - Premium Digital Products & Tools">
  <meta property="og:description" content="Discover top digital products at Toolpix Store: software, e-books, AI tools, and more. Get exclusive deals with instant, secure access.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://toolpix.netlify.app/store">
  <meta property="og:image" content="https://toolpix.netlify.app/images/toolpix-store-social-share.jpg">
  <meta property="og:site_name" content="Toolpix">
  <meta property="og:locale" content="en_US">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Toolpix Store - Shop Digital Products & Tools">
  <meta name="twitter:description" content="Find premium software, e-books, and AI tools at Toolpix Store. Secure, instant access with great discounts.">
  <meta name="twitter:image" content="https://toolpix.netlify.app/images/toolpix-store-twitter-card.jpg">
  <meta name="twitter:site" content="@toolpix">

  <!-- Favicon -->
  <link rel="icon" href="../static/images/favicon/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="180x180" href="../static/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../static/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../static/images/favicon/favicon-16x16.png">
  <link rel="manifest" href="../static/images/favicon/site.webmanifest">

  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <!-- JSON-LD Schema Markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "WebSite",
        "@id": "https://toolpix.netlify.app/#website",
        "name": "Toolpix",
        "url": "https://toolpix.netlify.app",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://toolpix.netlify.app/search?q={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      },
      {
        "@type": "WebPage",
        "@id": "https://toolpix.netlify.app/store/#webpage",
        "name": "Toolpix Store",
        "headline": "Toolpix Store - Buy Premium Digital Products & Tools",
        "description": "Shop at Toolpix Store for a wide range of digital products including software, e-books, AI tools, and productivity utilities. Enjoy the best deals and discounts with secure, instant access—no registration required.",
        "url": "https://toolpix.netlify.app/store",
        "image": "https://toolpix.netlify.app/images/toolpix-store-social-share.jpg",
        "datePublished": "2025-06-15",
        "dateModified": "2025-06-15",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://toolpix.netlify.app/store"
        },
        "author": {
          "@id": "https://toolpix.netlify.app/organization"
        },
        "publisher": {
          "@id": "https://toolpix.netlify.app/organization"
        },
        "keywords": [
          "digital products", "software", "e-books", "AI tools", "productivity tools",
          "digital store", "discounts", "deals", "Toolpix", "secure shopping"
        ],
        "potentialAction": {
          "@type": "ViewAction",
          "target": "https://toolpix.netlify.app/store",
          "name": "Shop Now"
        }
      },
      {
        "@type": "Organization",
        "@id": "https://toolpix.netlify.app/organization",
        "name": "Time Load Company",
        "url": "https://toolpix.netlify.app",
        "logo": {
          "@type": "ImageObject",
          "url": "https://toolpix.netlify.app/static/images/favicon/favicon.ico"
        },
        "founder": {
          "@type": "Person",
          "name": "Muhammed Ajmal U K",
          "url": "https://toolpix.netlify.app/about"
        },
        "contactPoint": {
          "@type": "ContactPoint",
          "contactType": "Customer Support",
          "email": "support@toolpix.com",
          "url": "https://toolpix.netlify.app/contact"
        },
        "sameAs": [
          "https://twitter.com/toolpix",
          "https://www.facebook.com/toolpix",
          "https://www.linkedin.com/company/toolpix"
        ]
      },
      {
        "@type": "OnlineStore",
        "@id": "https://toolpix.netlify.app/store/#onlinestore",
        "name": "Toolpix Store",
        "url": "https://toolpix.netlify.app/store",
        "description": "Toolpix Store offers premium digital products such as software, e-books, AI tools, and productivity utilities with secure transactions and instant access.",
        "areaServed": {
          "@type": "GeoShape",
          "box": "Worldwide"
        },
        "offers": {
          "@type": "Offer",
          "priceCurrency": "USD",
          "availability": "https://schema.org/InStock"
        },
        "publisher": {
          "@id": "https://toolpix.netlify.app/organization"
        }
      },
      {
        "@type": "SoftwareApplication",
        "name": "Toolpix Store",
        "applicationCategory": "EcommerceApplication",
        "applicationSubCategory": "Digital Store",
        "operatingSystem": "Web",
        "url": "https://toolpix.netlify.app/store",
        "installUrl": "https://toolpix.netlify.app/store",
        "description": "Toolpix Store is a digital marketplace offering premium software, e-books, AI tools, and productivity utilities with exclusive deals.",
        "screenshot": "https://toolpix.netlify.app/images/toolpix-store-social-share.jpg",
        "featureList": [
          "Premium software tools",
          "E-books and guides",
          "AI-powered utilities",
          "Productivity enhancements",
          "Secure transactions",
          "Instant digital delivery"
        ],
        "inLanguage": ["en", "und"],
        "offers": {
          "@type": "Offer",
          "priceCurrency": "USD",
          "availability": "https://schema.org/InStock"
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.7",
          "ratingCount": "800"
        },
        "review": [
          {
            "@type": "Review",
            "author": {
              "@type": "Person",
              "name": "Emma Wilson"
            },
            "datePublished": "2025-06-01",
            "reviewBody": "Great selection of digital tools and fast delivery. Highly recommend Toolpix Store!",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "5",
              "bestRating": "5"
            }
          },
          {
            "@type": "Review",
            "author": {
              "@type": "Person",
              "name": "Rahul Sharma"
            },
            "datePublished": "2025-06-03",
            "reviewBody": "Bought an AI tool and it was instantly available. Secure and easy process.",
            "reviewRating": {
              "@type": "Rating",
              "ratingValue": "4.5",
              "bestRating": "5"
            }
          }
        ],
        "publisher": {
          "@id": "https://toolpix.netlify.app/organization"
        }
      },
      {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://toolpix.netlify.app/"},
          {"@type": "ListItem", "position": 2, "name": "Store", "item": "https://toolpix.netlify.app/store"}
        ]
      },
      {
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "What products are available at Toolpix Store?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Toolpix Store offers premium digital products including software, e-books, AI tools, productivity utilities, and more."
            }
          },
          {
            "@type": "Question",
            "name": "Is shopping at Toolpix Store secure?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Yes, Toolpix Store uses secure transaction methods to ensure safe and reliable purchases."
            }
          },
          {
            "@type": "Question",
            "name": "Do I need an account to buy from Toolpix Store?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "No, you can purchase products without registration for quick and easy access."
            }
          },
          {
            "@type": "Question",
            "name": "How do I access my purchased products?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "After purchase, you’ll receive instant access to your digital products via email or direct download."
            }
          },
          {
            "@type": "Question",
            "name": "Can I shop at Toolpix Store in my own language?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Toolpix Store supports browser-based language detection, allowing users worldwide to shop in their preferred language."
            }
          }
        ]
      }
    ]
  }
  </script>  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fafb;
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .slide-up {
      animation: slideUp 0.3s ease-out;
    }
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .gradient-text {
      background: linear-gradient(90deg, #8b5cf6 0%, #3b82f6 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    @keyframes progress {
      0% { width: 0%; }
      100% { width: 100%; }
    }
    .animate-progress {
      animation: progress 2s linear infinite;
      background: #8b5cf6;
    }
    .hover-scale {
      transition: transform 0.3s ease;
    }
    .hover-scale:hover {
      transform: scale(1.03);
    }
    .custom-shadow {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }
    .btn-primary {
      background-color: #8b5cf6;
      color: white;
      transition: background-color 0.3s ease;
    }
    .btn-primary:hover {
      background-color: #7c3aed;
    }
    .btn-secondary {
      background-color: #e5e7eb;
      color: #374151;
      transition: background-color 0.3s ease;
    }
    .btn-secondary:hover {
      background-color: #d1d5db;
    }
    .square-aspect {
      position: relative;
      width: 100%;
      padding-top: 100%;
    }
    .square-aspect > img,
    .square-aspect > .gradient-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <!-- Splash Screen -->
  <div id="splash-screen" class="fixed inset-0 bg-gradient-to-br from-purple-600 to-blue-600 flex flex-col items-center justify-center z-50">
    <div class="animate-bounce mb-8">
      <svg class="w-20 h-20 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
      </svg>
    </div>
    <h1 class="text-4xl font-bold text-white mb-2">Toolpix Store</h1>
    <p class="text-white opacity-80">Loading amazing products...</p>
    <div class="mt-8 w-64 bg-white bg-opacity-20 rounded-full h-2">
      <div class="h-2 rounded-full animate-progress"></div>
    </div>
  </div>

  <!-- Main App -->
  <div id="app" class="min-h-screen hidden">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-30 custom-shadow">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex-shrink-0 flex items-center">
            <h1 class="text-xl font-bold gradient-text">Toolpix Store</h1>
          </div>
          
          <div class="hidden md:flex flex-1 max-w-md mx-4">
            <div class="relative w-full">
              <input
  type="text"
  id="search-input"
  placeholder="Search products..."
  class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
>
              <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
              <button
                id="clear-search"
                class="absolute right-3 top-3 text-gray-400 hover:text-gray-600 hidden"
                aria-label="Clear search"
              >
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
          
          <div class="hidden md:flex items-center space-x-4">
            <button 
              id="favorites-button"
              class="p-2 rounded-full text-gray-600 hover:text-purple-500 relative"
              aria-label="Favorites"
            >
              <i class="fas fa-heart"></i>
              <span id="favorites-count" class="absolute -top-1 -right-1 bg-purple-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">
                0
              </span>
            </button>
            
            <div class="relative">
              <select
                id="category-filter"
                class="appearance-none bg-gray-50 border border-gray-200 rounded-lg pl-3 pr-8 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
              >
                <option value="all">All Categories</option>
              </select>
              <i class="fas fa-chevron-down absolute right-3 top-3 text-xs text-gray-500 pointer-events-none"></i>
            </div>
            
            <div class="relative">
              <select
                id="sort-select"
                class="appearance-none bg-gray-50 border border-gray-200 rounded-lg pl-3 pr-8 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
              >
                <option value="default">Sort By</option>
                <option value="price-low">Price: Low to High</option>
                <option value="price-high">Price: High to Low</option>
                <option value="discount-high">Highest Discount</option>
                <option value="newest">Newest First</option>
                <option value="rating">Highest Rated</option>
              </select>
              <i class="fas fa-chevron-down absolute right-3 top-3 text-xs text-gray-500 pointer-events-none"></i>
            </div>
          </div>
          
          <div class="md:hidden flex items-center">
            <button 
              id="mobile-search-button"
              class="p-2 text-gray-600 hover:text-gray-900"
              aria-label="Search"
            >
              <i class="fas fa-search"></i>
            </button>
            <button 
              id="mobile-menu-button"
              class="p-2 text-gray-600 hover:text-gray-900 ml-2"
              aria-label="Menu"
            >
              <i class="fas fa-ellipsis-v"></i>
            </button>
          </div>
        </div>
      </div>
    </header>
    
    <!-- Active Filters -->
    <div id="active-filters" class="bg-white py-2 px-4 border-b border-gray-100 hidden">
      <div class="max-w-7xl mx-auto flex flex-wrap items-center gap-2">
        <button 
          id="clear-all-filters"
          class="text-purple-600 text-sm font-medium hover:text-purple-800 ml-auto"
        >
          Clear all
        </button>
      </div>
    </div>
    
    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <!-- Error State -->
      <div id="error-state" class="text-center py-12 hidden">
        <i class="fas fa-exclamation-triangle text-yellow-500 text-5xl mb-4"></i>
        <h3 class="text-lg font-medium text-gray-700">Failed to Load Products</h3>
        <p class="text-gray-500 mt-2">Please try refreshing the page or check your connection.</p>
        <button 
          id="refresh-button"
          class="mt-4 px-4 py-2 btn-primary rounded-lg hover:bg-purple-700 transition"
        >
          Refresh Page
        </button>
      </div>
      
      <!-- Hero Banner -->
      <div id="hero-banner" class="rounded-xl overflow-hidden mb-8 cursor-pointer hidden custom-shadow hover-scale">
  <div class="relative h-48 sm:h-64 md:h-80 lg:h-96">
    <img id="banner-image" src="https://placehold.co/600x400?text=Toolpix" alt="Banner image" class="w-full h-full object-cover">
    <span id="banner-discount" class="absolute top-2 left-2 z-10 bg-white bg-opacity-80 text-orange-500 text-xs font-semibold px-2 py-1 rounded-full border border-orange-200 hidden">
      0% OFF
    </span>
  </div>
  <div class="p-4 sm:p-6 bg-white"><h2 id="banner-title" class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">Featured Product</h2>
    <!--<p id="banner-description" class="text-sm md:text-base text-gray-600 mb-3 line-clamp-2"></p>-->
    <div class="flex items-center">
      <span id="banner-price" class="text-xl font-bold text-purple-600 mr-3"></span>
      <span id="banner-original-price" class="text-sm line-through text-gray-500 hidden"></span>
    </div>
  </div>
</div>
      
      <!-- Products -->
      <section id="trending-section" class="mb-12">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-bold text-gray-800">Products</h2>
          <button class="text-purple-600 hover:text-purple-800 text-sm font-medium">
            View All
          </button>
        </div>
        <div id="trending-products" class="grid grid-cols-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 sm:gap-4">
        </div>
      </section>
      
      <!-- Latest Products -->
      <section id="latest-section" class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Latest Products</h2>
        <div id="latest-products" class="grid grid-cols-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 sm:gap-4">
        </div>
      </section>
      
      <!-- Search/Filter Results -->
      <section id="search-results" class="hidden"><h2 id="search-results-title" class="text-2xl font-bold text-gray-800 mb-6">Search Results</h2>
        <div id="search-results-empty" class="text-center py-12 hidden">
          <i class="fas fa-search text-gray-300 text-5xl mb-4"></i>
          <h3 class="text-lg font-medium text-gray-700">No Products Found</h3>
          <p class="text-gray-500 mt-2">Try adjusting your search or filter criteria, or refresh the page.</p>
          <div class="mt-4 space-x-4">
            <button 
              id="clear-search-filter"
              class="px-4 py-2 btn-primary rounded-lg hover:bg-purple-700 transition"
            >
              Clear All
            </button>
            <button 
              id="refresh-button-2"
              class="px-4 py-2 btn-primary rounded-lg hover:bg-purple-700 transition"
            >
              Refresh Page
            </button>
          </div>
        </div>
        <div id="filtered-products" class="grid grid-cols-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 sm:gap-4">
        </div>
        <div id="pagination" class="flex justify-center mt-8 hidden">
          <nav class="inline-flex rounded-md shadow">
            <button
              id="prev-page"
              class="px-3 py-2 rounded-l-md border border-gray-200 bg-white text-gray-500 hover:bg-gray-50 disabled:opacity-50"
              disabled
            >
              <i class="fas fa-chevron-left"></i>
            </button>
            <button
              id="next-page"
              class="px-3 py-2 rounded-r-md border border-gray-200 bg-white text-gray-500 hover:bg-gray-50 disabled:opacity-50"
              disabled
            >
              <i class="fas fa-chevron-right"></i>
            </button>
          </nav>
        </div>
      </section>
    </main>
    
    <!-- Mobile Search -->
    <div id="mobile-search" class="fixed inset-0 bg-white z-50 overflow-y-auto p-4 hidden">
      <div class="flex items-center mb-4">
        <button 
          id="close-mobile-search"
          class="mr-4 text-gray-600"
          aria-label="Close search"
        >
          <i class="fas fa-arrow-left"></i>
        </button>
        <div class="relative flex-1">
         <input
  type="text"
  id="mobile-search-input"
  placeholder="Search products..."
  class="w-full py-3 px-4 pl-10 bg-gray-50 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
>
          <i class="fas fa-search absolute left-3 top-3.5 text-gray-500"></i>
          <button
            id="clear-mobile-search"
            class="absolute right-3 top-3.5 text-gray-500 hidden"
            aria-label="Clear search"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div id="mobile-search-results" class="mt-4">
      </div>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-end hidden">
      <div class="bg-white w-4/5 max-w-sm h-full overflow-y-auto slide-up">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
          <h3 class="text-lg font-semibold">Menu</h3>
          <button 
            id="close-mobile-menu"
            class="text-gray-500 hover:text-gray-700"
            aria-label="Close menu"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <div class="p-4">
          <h4 class="font-medium text-gray-700 mb-2">Filter By</h4>
          <div class="space-y-3">
            <div>
              <label class="block text-sm text-gray-600 mb-1">Category</label>
              <select
                id="mobile-category-filter"
                class="w-full p-2 border rounded-lg focus:border-purple-500 focus:ring focus:ring-purple-200"
              >
                <option value="all">All Categories</option>
              </select>
            </div>
            
            <div>
              <label class="block text-sm text-gray-600 mb-1">Price Range</label>
              <select
                id="mobile-price-filter"
                class="w-full p-2 border rounded-lg focus:border-purple-500 focus:ring focus:ring-purple-200"
              >
                <option value="all">All Prices</option>
                <option value="0-10">Under ₹10</option>
                <option value="10-25">₹10 - ₹25</option>
                <option value="25-50">₹25 - ₹50</option>
                <option value="50-100">₹50 - ₹100</option>
                <option value="100+">Over ₹100</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="p-4 border-t border-gray-100">
          <h4 class="font-medium text-gray-700 mb-2">Sort By</h4>
          <div class="space-y-2">
            <button 
              id="sort-default"
              class="w-full text-left p-2 rounded-lg bg-purple-100 text-purple-700"
            >
              Default
            </button>
            <button 
              id="sort-price-low"
              class="w-full text-left p-2 rounded-lg hover:bg-gray-50"
            >
              Price: Low to High
            </button>
            <button 
              id="sort-price-high"
              class="w-full text-left p-2 rounded-lg hover:bg-gray-50"
            >
              Price: High to Low
            </button>
            <button 
              id="sort-discount-high"
              class="w-full text-left p-2 rounded-lg hover:bg-gray-50"
            >
              Highest Discount
            </button>
            <button 
              id="sort-newest"
              class="w-full text-left p-2 rounded-lg hover:bg-gray-50"
            >
              Newest First
            </button>
            <button 
              id="sort-rating"
              class="w-full text-left p-2 rounded-lg hover:bg-gray-50"
            >
              Highest Rated
            </button>
          </div>
        </div>
        
        <div class="p-4 border-t border-gray-100">
          <button 
            id="mobile-favorites-button"
            class="w-full flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg"
          >
            <span>My Favorites</span>
            <i class="fas fa-heart text-purple-500"></i>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Favorites Panel -->
    <div id="favorites-panel" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex justify-end hidden">
      <div class="bg-white w-full max-w-md h-full overflow-y-auto slide-up">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white z-10">
          <h3 class="text-lg font-semibold flex items-center gap-2">
            <i class="fas fa-heart text-purple-500"></i> My Favorites
          </h3>
          <button 
            id="close-favorites"
            class="text-gray-500 hover:text-gray-700"
            aria-label="Close favorites"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <div id="favorites-content" class="p-4"> 
        </div>
      </div>
    </div>
    
    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4 hidden">
      <div class="bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden custom-shadow relative">
        <button 
          id="close-product-modal"
          class="absolute top-4 right-4 z-10 bg-white p-2 rounded-full shadow hover:bg-gray-50 transition"
          aria-label="Close modal"
        >
          <i class="fas fa-times text-gray-600"></i>
        </button>
        
        <div id="modal-content" class="grid md:grid-cols-2 gap-0">  
        </div>
      </div>
    </div>
    
    <!-- Popup Banner -->
    <div id="popup-banner" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
      <div class="bg-white rounded-xl w-full max-w-md custom-shadow">
        <div class="relative">
          <img
  id="popup-image"
  src="https://placehold.co/600x400?text=Toolpix"
  alt="Popup banner"
  class="w-full h-48 object-cover rounded-t-xl"
  onerror="this.src='https://placehold.co/600x400?text=Toolpix'"
>
          <button 
            id="close-popup-banner"
            class="absolute top-2 right-2 p-2 bg-white bg-opacity-75 rounded-full text-gray-500 hover:text-gray-700 hover:bg-opacity-100 transition z-10"
            aria-label="Close popup"
          >
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
        <div id="popup-content" class="p-4 cursor-pointer">
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <footer class="bg-white border-t border-gray-100 mt-12 custom-shadow">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Toolpix Store</h3>
            <p class="text-gray-600">Your one-stop shop for digital products and tools.</p>
          </div>
          <div>
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Links</h3>
            <ul class="space-y-2">
              <li><a href="../" class="text-gray-600 hover:text-purple-600">Home</a></li>
              <li><a href="#" class="text-gray-600 hover:text-purple-600">Products</a></li>
              <li><a href="#" class="text-gray-600 hover:text-purple-600">Categories</a></li>
              <li><a href="../contact" class="text-gray-600 hover:text-purple-600">Contact</a></li>
            </ul>
          </div>
          <div>
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Contact Us</h3>
            <p class="text-gray-600">Email: support@toolpixstore.com</p>
            <div class="flex space-x-4 mt-4">
              <a href="https://www.facebook.com/toolpixstore" class="text-gray-600 hover:text-purple-600"><i class="fab fa-facebook-f"></i></a>
              <a href="https://www.youtube.com/@toolpixstore" class="text-gray-600 hover:text-purple-600"><i class="fab fa-youtube"></i></a>
              <a href="https://www.instagram.com/toolpixstore" class="text-gray-600 hover:text-purple-600"><i class="fab fa-instagram"></i></a>
            </div>
          </div>
        </div>
        <div class="mt-8 pt-8 border-t border-gray-100 text-center text-gray-500 text-sm">
          <p>© <span id="current-year"></span> Toolpix Store. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // Constants
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz-gJTI2VPDNsWdKP_-kBJvDY2YHTHz5V1fmh0dV0e1UW8cbX8i9E1SWtdusGZFJ2ze/exec";
    const PLACEHOLDER_IMAGE = "https://placehold.co/600x400?text=Toolpix";
    const CACHE_KEY = 'toolpix_products_v3';
    const FAVORITES_KEY = 'toolpix_favorites';
    const CACHE_DURATION = 15 * 60 * 1000; // 15 minutes cache
    const ITEMS_PER_PAGE = 12;
    const CURRENCY_CODE = 'INR';

    // State
    let products = [];
    let filteredProducts = [];
    let latestProducts = [];
    let currentPage = 1;
    let filters = {};
    let sort = 'default';
    let favorites = [];
    let selectedProduct = null;
    let categories = [];
    let bannerProduct = null;
    let popupProduct = null;

    // DOM Elements
    const splashScreen = document.getElementById('splash-screen');
    const app = document.getElementById('app');
    const errorState = document.getElementById('error-state');
    const refreshButton = document.getElementById('refresh-button');
    const refreshButton2 = document.getElementById('refresh-button-2');
    const heroBanner = document.getElementById('hero-banner');
    const bannerImage = document.getElementById('banner-image');
    const bannerDiscount = document.getElementById('banner-discount');
    const bannerTitle = document.getElementById('banner-title');
    //const bannerDescription = document.getElementById('banner-description');
    const bannerPrice = document.getElementById('banner-price');
    const bannerOriginalPrice = document.getElementById('banner-original-price');
    const trendingSection = document.getElementById('trending-section');
    const trendingProductsContainer = document.getElementById('trending-products');
    const latestSection = document.getElementById('latest-section');
    const latestProductsContainer = document.getElementById('latest-products');
    const searchResults = document.getElementById('search-results');
    const searchResultsTitle = document.getElementById('search-results-title');
    const searchResultsEmpty = document.getElementById('search-results-empty');
    const filteredProductsContainer = document.getElementById('filtered-products');
    const pagination = document.getElementById('pagination');
    const prevPageButton = document.getElementById('prev-page');
    const nextPageButton = document.getElementById('next-page');
    const clearSearchFilter = document.getElementById('clear-search-filter');
    const activeFilters = document.getElementById('active-filters');
    const clearAllFilters = document.getElementById('clear-all-filters');
    const searchInput = document.getElementById('search-input');
    const clearSearch = document.getElementById('clear-search');
    const categoryFilter = document.getElementById('category-filter');
    const sortSelect = document.getElementById('sort-select');
    const favoritesButton = document.getElementById('favorites-button');
    const favoritesCount = document.getElementById('favorites-count');
    const mobileSearchButton = document.getElementById('mobile-search-button');
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileSearch = document.getElementById('mobile-search');
    const closeMobileSearch = document.getElementById('close-mobile-search');
    const mobileSearchInput = document.getElementById('mobile-search-input');
    const clearMobileSearch = document.getElementById('clear-mobile-search');
    const mobileSearchResults = document.getElementById('mobile-search-results');
    const mobileMenu = document.getElementById('mobile-menu');
    const closeMobileMenu = document.getElementById('close-mobile-menu');
    const mobileCategoryFilter = document.getElementById('mobile-category-filter');
    const mobilePriceFilter = document.getElementById('mobile-price-filter');
    const sortDefault = document.getElementById('sort-default');
    const sortPriceLow = document.getElementById('sort-price-low');
    const sortPriceHigh = document.getElementById('sort-price-high');
    const sortDiscountHigh = document.getElementById('sort-discount-high');
    const sortNewest = document.getElementById('sort-newest');
    const sortRating = document.getElementById('sort-rating');
    const mobileFavoritesButton = document.getElementById('mobile-favorites-button');
    const favoritesPanel = document.getElementById('favorites-panel');
    const closeFavorites = document.getElementById('close-favorites');
    const favoritesContent = document.getElementById('favorites-content');
    const productModal = document.getElementById('product-modal');
    const closeProductModal = document.getElementById('close-product-modal');
    const modalContent = document.getElementById('modal-content');
    const popupBanner = document.getElementById('popup-banner');
    const closePopupBanner = document.getElementById('close-popup-banner');
    const popupContent = document.getElementById('popup-content');
    const currentYear = document.getElementById('current-year');

    // Helper Functions
    function formatPrice(price) {
      return new Intl.NumberFormat('en-IN', {
        style: 'currency',
        currency: CURRENCY_CODE
      }).format(price);
    }

    function getFavorites() {
      return JSON.parse(localStorage.getItem(FAVORITES_KEY)) || [];
    }

    function toggleFavorite(productId) {
      const favorites = getFavorites();
      const newFavorites = favorites.includes(productId)
        ? favorites.filter(id => id !== productId)
        : [...favorites, productId];
      localStorage.setItem(FAVORITES_KEY, JSON.stringify(newFavorites));
      return newFavorites;
    }

    function updateFavoriteButton(productId, button) {
      const isFavorite = favorites.includes(productId);
      const icon = button.querySelector('i');
      icon.className = isFavorite ? 'fas fa-heart text-purple-500' : 'far fa-heart text-gray-400';
      button.setAttribute('aria-label', isFavorite ? 'Remove from favorites' : 'Add to favorites');
    }

    function renderActiveFilters() {
      const activeFiltersContainer = activeFilters.querySelector('div');
      activeFiltersContainer.innerHTML = '';
      
      let hasFilters = false;
      
      Object.entries(filters).forEach(([key, value]) => {
        if (value && value !== 'all') {
          hasFilters = true;
          const filterElement = document.createElement('div');
          filterElement.className = 'bg-gray-50 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center';
          filterElement.innerHTML = `
            <span class="capitalize">${key}: ${value}</span>
            <button 
              data-filter="${key}"
              class="ml-2 text-gray-500 hover:text-gray-700 remove-filter"
              aria-label="Remove ${key} filter"
            >
              <i class="fas fa-times text-xs"></i>
            </button>
          `;
          activeFiltersContainer.appendChild(filterElement);
        }
      });
      
      if (sort !== 'default') {
        hasFilters = true;
        const sortElement = document.createElement('div');
        sortElement.className = 'bg-gray-50 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center';
        sortElement.innerHTML = `
          <span>Sort: ${
            sort === 'price-low' ? 'Price: Low to High' :
            sort === 'price-high' ? 'Price: High to Low' :
            sort === 'discount-high' ? 'Highest Discount' :
            sort === 'newest' ? 'Newest First' :
            'Highest Rated'
          }</span>
          <button 
            class="ml-2 text-gray-500 hover:text-gray-700 remove-sort"
            aria-label="Remove sort"
          >
            <i class="fas fa-times text-xs"></i>
          </button>
        `;
        activeFiltersContainer.appendChild(sortElement);
      }
      
      activeFilters.classList.toggle('hidden', !hasFilters);
    }

function renderProducts(products, container) {
  container.innerHTML = '';
  
  products.forEach(product => {
    const isFavorite = favorites.includes(product.Id);
    const isDiscounted = product.discountPercentage > 0;
    
    const productElement = document.createElement('div');
    productElement.className = 'bg-white rounded-xl overflow-hidden custom-shadow hover:shadow-xl transition-shadow duration-300 relative fade-in product-card cursor-pointer hover-scale';
    productElement.innerHTML = `
<button 
  class="absolute top-2 right-2 z-10 w-5 h-5 sm:w-7 sm:h-7 flex items-center justify-center bg-white bg-opacity-80 rounded-full shadow hover:bg-opacity-100 transition favorite-button"
  data-id="${product.Id}"
  aria-label="${isFavorite ? 'Remove from favorites' : 'Add to favorites'}"
>
  <i class="${isFavorite ? 'fas text-purple-500' : 'far text-gray-400'} fa-heart text-xs sm:text-sm"></i>
</button> 
      
      <div class="relative square-aspect overflow-hidden">
        <img
          src="${product.ImageURLs[0] || PLACEHOLDER_IMAGE}"
          alt="${product.Title}"
          class="object-cover"
          onerror="this.src='${PLACEHOLDER_IMAGE}'"
        />
        <div class="gradient-overlay absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"></div>
        ${isDiscounted ? `
          <span class="absolute top-2 left-2 z-10 bg-white bg-opacity-80 text-orange-500 text-xs font-semibold px-1 sm:px-2 py-0.5 sm:py-1 rounded-full border border-orange-200">
            ${product.discountPercentage}% 
          </span>
        ` : ''}
      </div>
      
      <div class="p-2 md:p-4">
        <h3 class="text-xs sm:text-sm md:text-lg font-semibold text-gray-800 mb-1 truncate hover:text-purple-600 transition">
          ${product.Title}
        </h3>
        <div class="flex items-center flex-wrap gap-1">
          ${product.currentPrice === 0 ? 
            `<span class="text-xs sm:text-sm md:text-lg font-bold text-green-600">Free</span>` :
            `
            <span class="text-xs sm:text-sm md:text-lg font-bold text-purple-600">${formatPrice(product.currentPrice)}</span>
            ${isDiscounted ? `
              <span class="text-xs text-gray-500 line-through">${formatPrice(product.originalPrice)}</span>
            ` : ''}
            `
          }
        </div>
      </div>
    `;
    
    container.appendChild(productElement);
    
    productElement.addEventListener('click', () => {
      viewProduct(product);
    });
    
    const favoriteButton = productElement.querySelector('.favorite-button');
    favoriteButton.addEventListener('click', (e) => {
      e.stopPropagation();
      const productId = favoriteButton.getAttribute('data-id');
      favorites = toggleFavorite(productId);
      updateFavoritesCount();
      updateFavoriteButton(productId, favoriteButton);
    });
  });
}

    function renderPagination() {
      const pageCount = Math.ceil(filteredProducts.length / ITEMS_PER_PAGE);
      
      if (pageCount <= 1) {
        pagination.classList.add('hidden');
        return;
      }
      
      pagination.classList.remove('hidden');
      const paginationContainer = pagination.querySelector('nav');
      
      while (paginationContainer.children.length > 2) {
        paginationContainer.removeChild(paginationContainer.children[1]);
      }
      
      const maxPagesToShow = 5;
      let startPage, endPage;
      
      if (pageCount <= maxPagesToShow) {
        startPage = 1;
        endPage = pageCount;
      } else if (currentPage <= Math.ceil(maxPagesToShow / 2)) {
        startPage = 1;
        endPage = maxPagesToShow;
      } else if (currentPage >= pageCount - Math.floor(maxPagesToShow / 2)) {
        startPage = pageCount - maxPagesToShow + 1;
        endPage = pageCount;
      } else {
        startPage = currentPage - Math.floor(maxPagesToShow / 2);
        endPage = currentPage + Math.floor(maxPagesToShow / 2);
      }
      
      for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.textContent = i;
        pageButton.className = `px-4 py-2 border-t border-b border-gray-200 ${currentPage === i ? 'bg-purple-600 text-white' : 'bg-white text-gray-500 hover:bg-gray-50'}`;
        pageButton.addEventListener('click', () => {
          currentPage = i;
          renderFilteredProducts();
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        paginationContainer.insertBefore(pageButton, paginationContainer.lastChild);
      }
      
      prevPageButton.disabled = currentPage === 1;
      nextPageButton.disabled = currentPage === pageCount;
    }

    function renderFilteredProducts() {
      const start = (currentPage - 1) * ITEMS_PER_PAGE;
      const paginatedProducts = filteredProducts.slice(start, start + ITEMS_PER_PAGE);
      
      renderProducts(paginatedProducts, filteredProductsContainer);
      renderPagination();
    }

    function renderAllProducts() {
      updateFavoritesCount();
      
      const hasSearchOrFilters = searchInput.value || Object.keys(filters).some(key => filters[key] && filters[key] !== 'all') || sort !== 'default';
      
      if (hasSearchOrFilters) {
        trendingSection.classList.add('hidden');
        latestSection.classList.add('hidden');
        searchResults.classList.remove('hidden');
        
        if (filteredProducts.length === 0) {
          searchResultsEmpty.classList.remove('hidden');
          filteredProductsContainer.classList.add('hidden');
          pagination.classList.add('hidden');
          
          searchResultsTitle.textContent = searchInput.value ? `Search Results for "${searchInput.value}"` : 'Filtered Products';
        } else {
          searchResultsEmpty.classList.add('hidden');
          filteredProductsContainer.classList.remove('hidden');
          
          searchResultsTitle.textContent = searchInput.value ? `Search Results for "${searchInput.value}" (${filteredProducts.length})` : `Filtered Products (${filteredProducts.length})`;
          
          renderFilteredProducts();
        }
      } else {
        trendingSection.classList.remove('hidden');
        latestSection.classList.remove('hidden');
        searchResults.classList.add('hidden');
        
        renderProducts(products, trendingProductsContainer);
        renderProducts(latestProducts, latestProductsContainer);
      }
      
      heroBanner.classList.toggle('hidden', hasSearchOrFilters || selectedProduct);
    }

    function updateFavoritesCount() {
      const count = favorites.length;
      favoritesCount.textContent = count;
      favoritesCount.classList.toggle('hidden', count === 0);
    }

    function viewProduct(product) {
      try {
        selectedProduct = product;
        window.location.hash = product.Id;
        
        modalContent.innerHTML = `
          <div class="relative h-64 md:h-96">
            <img
              src="${product.ImageURLs[0] || PLACEHOLDER_IMAGE}"
              alt="${product.Title}"
              class="w-full h-full object-contain"
              onerror="this.src='${PLACEHOLDER_IMAGE}'"
            />
          </div>
          
          <div class="pt-12 p-4 md:pt-14 md:p-6 overflow-y-auto max-h-[90vh]">
            <div class="flex items-start justify-between mb-4">
              <div>
                <h2 class="text-xl md:text-2xl font-bold text-gray-800">${product.Title}</h2>
              </div>
              
              <div class="text-right">
                ${product.currentPrice === 0 ? 
                  `<div class="text-2xl font-bold md:text-3xl text-green-600">Free</div>` :
                  `
                    <span class="text-sm text-gray-500">Price:</span>
                    <div class="text-2xl font-bold md:text-3xl text-purple-600">${formatPrice(product.currentPrice)}</div>
                    ${product.discountPercentage > 0 ? `
                      <div class="text-sm text-orange-500 font-medium">${product.discountPercentage}% OFF</div>
                      <div class="text-sm text-gray-500 line-through">${formatPrice(product.originalPrice)}</div>
                    ` : ''}
                  `
                }
              </div>
            </div>
            
            <div class="mb-6">
              <div class="border-b border-gray-100">
                <nav class="flex -mb-px">
                  <button class="py-2 px-4 text-center border-b-2 font-medium text-sm border-purple-500 text-purple-600 tab-button active" data-tab="details">
                    Details
                  </button>
                  <button class="py-2 px-4 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 tab-button" data-tab="features">
                    Features
                  </button>
                </nav>
              </div>
              
              <div class="mt-4 text-gray-600 text-sm md:text-base">
                <div id="tab-details" class="tab-content active">
                  <p>${product.Description || 'No detailed description available.'}</p>
                </div>
                <div id="tab-features" class="tab-content hidden">
                  <ul class="list-disc pl-5 space-y-1">
                    ${product.Features ? 
                      product.Features.split('\n').filter(f => f.trim()).map(feature => `<li>${feature}</li>`).join('') : 
                      '<li>No features listed</li>'
                    }
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="flex flex-row gap-3">
              <a
                href="${product.PurchaseLink || '#'}"
                target="_blank"
                rel="noopener noreferrer"
                class="flex-1 ${product.currentPrice === 0 ? 'bg-green-500 hover:bg-green-600' : 'btn-primary'} font-medium py-2 px-4 rounded-lg text-center transition flex items-center justify-center gap-2 text-sm md:text-base"
              >
                <i class="fas ${product.currentPrice === 0 ? 'fa-download' : 'fa-shopping-cart'}"></i> ${product.currentPrice === 0 ? 'Get Now' : 'Buy Now'}
              </a>
              <button 
                class="flex-1 ${favorites.includes(product.Id) ? 'bg-purple-100 hover:bg-purple-200 text-purple-700' : 'bg-blue-100 hover:bg-blue-200 text-blue-700'} font-medium py-2 px-4 rounded-lg transition flex items-center justify-center gap-2 favorite-button-modal text-sm md:text-base"
                data-id="${product.Id}"
              >
                <i class="${favorites.includes(product.Id) ? 'fas' : 'far'} fa-heart"></i> ${favorites.includes(product.Id) ? 'Remove from Wishlist' : 'Add to Wishlist'}
              </button>
            </div>
            
            ${product.Category ? `
              <div class="mt-6 pt-6 border-t border-gray-100">
                <span class="text-sm text-gray-500">Category: </span>
                <span class="text-sm font-medium">${product.Category}</span>
              </div>
            ` : ''}
          </div>
        `;
        
        modalContent.querySelectorAll('.tab-button').forEach(button => {
          button.addEventListener('click', () => {
            const tab = button.getAttribute('data-tab');
            
            modalContent.querySelectorAll('.tab-button').forEach(btn => {
              btn.classList.remove('border-purple-500', 'text-purple-600', 'active');
              btn.classList.add('border-transparent', 'text-gray-500');
            });
            button.classList.add('border-purple-500', 'text-purple-600', 'active');
            
            modalContent.querySelectorAll('.tab-content').forEach(content => {
              content.classList.add('hidden');
              content.classList.remove('active');
            });
            modalContent.querySelector(`#tab-${tab}`).classList.remove('hidden');
            modalContent.querySelector(`#tab-${tab}`).classList.add('active');
          });
        });
        
        modalContent.querySelector('.favorite-button-modal').addEventListener('click', () => {
          const productId = modalContent.querySelector('.favorite-button-modal').getAttribute('data-id');
          favorites = toggleFavorite(productId);
          updateFavoritesCount();
          
          const button = modalContent.querySelector('.favorite-button-modal');
          if (favorites.includes(productId)) {
            button.innerHTML = '<i class="fas fa-heart"></i> Remove from Wishlist';
            button.className = 'flex-1 bg-purple-100 hover:bg-purple-200 text-purple-700 font-medium py-2 px-4 rounded-lg transition flex items-center justify-center gap-2 favorite-button-modal text-sm md:text-base';
          } else {
            button.innerHTML = '<i class="far fa-heart"></i> Add to Wishlist';
            button.className = 'flex-1 bg-blue-100 hover:bg-blue-200 text-blue-700 font-medium py-2 px-4 rounded-lg transition flex items-center justify-center gap-2 favorite-button-modal text-sm md:text-base';
          }
          
          document.querySelectorAll(`.favorite-button[data-id="${productId}"]`).forEach(btn => {
            updateFavoriteButton(productId, btn);
          });
        });
        
        productModal.classList.remove('hidden');
      } catch (error) {
        console.error('Error in viewProduct:', error);
      }
    }

    function renderFavorites() {
      const favoriteProducts = products.filter(p => favorites.includes(p.Id));
      
      if (favoriteProducts.length === 0) {
        favoritesContent.innerHTML = `
          <div class="text-center py-10">
            <i class="far fa-heart text-gray-300 text-5xl mb-4"></i>
            <h4 class="text-lg font-medium text-gray-700">No favorites yet</h4>
            <p class="text-gray-500 mt-2">Tap the heart icon on products to add them here</p>
          </div>
        `;
      } else {
        favoritesContent.innerHTML = `
          <div class="grid grid-cols-1 gap-4">
            ${favoriteProducts.map(product => `
              <div class="flex items-center border-b border-gray-100 pb-4">
                <div class="w-16 h-16 rounded-lg overflow-hidden mr-4 cursor-pointer view-product" data-id="${product.Id}">
                  <img
                    src="${product.ImageURLs[0] || PLACEHOLDER_IMAGE}"
                    alt="${product.Title}"
                    class="w-full h-full object-cover"
                    onerror="this.src='${PLACEHOLDER_IMAGE}'"
                  />
                </div>
                <div class="flex-1">
                  <h4 class="text-sm md:text-base font-medium text-gray-800 cursor-pointer hover:text-purple-600 view-product" data-id="${product.Id}">
                    ${product.Title}
                  </h4>
                  <div class="flex items-center justify-between mt-1">
                    <span class="text-sm md:text-base font-semibold ${product.currentPrice === 0 ? 'text-green-600' : 'text-purple-600'}">
                      ${product.currentPrice === 0 ? 'Free' : formatPrice(product.currentPrice)}
                    </span>
                    <button 
                      class="text-purple-500 hover:text-purple-700 remove-favorite"
                      data-id="${product.Id}"
                      aria-label="Remove from favorites"
                    >
                      <i class="fas fa-trash-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        `;
        
        favoritesContent.querySelectorAll('.view-product').forEach(button => {
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            const productId = button.getAttribute('data-id');
            const product = products.find(p => p.Id === productId);
            if (product) {
              viewProduct(product);
              favoritesPanel.classList.add('hidden');
            }
          });
        });
        
        favoritesContent.querySelectorAll('.remove-favorite').forEach(button => {
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            const productId = button.getAttribute('data-id');
            favorites = toggleFavorite(productId);
            updateFavoritesCount();
            renderFavorites();
            document.querySelectorAll(`.favorite-button[data-id="${productId}"]`).forEach(btn => {
              updateFavoriteButton(productId, btn);
            });
          });
        });
      }
    }

    function renderPopupBanner() {
      if (!popupProduct) return;
      
      const isDiscounted = popupProduct.discountPercentage > 0;
      
      document.getElementById('popup-image').src = popupProduct.ImageURLs[0] || PLACEHOLDER_IMAGE;
      document.getElementById('popup-image').alt = popupProduct.Title;
      
      popupContent.innerHTML = `
        <h2 class="text-xl font-bold text-gray-800 mb-2">${popupProduct.Title}</h2>
        <p class="text-gray-600 mb-2">${popupProduct.Description}</p>
        <div class="flex items-center flex-wrap gap-2">
          ${popupProduct.currentPrice === 0 ? 
            `<span class="text-lg font-bold text-green-600">Free</span>` :
            `
              <span class="text-lg font-bold text-purple-600">${formatPrice(popupProduct.currentPrice)}</span>
              ${isDiscounted ? `
                <span class="text-xs text-orange-500 font-medium">${popupProduct.discountPercentage}% OFF</span>
                <span class="text-xs text-gray-500 line-through">${formatPrice(popupProduct.originalPrice)}</span>
              ` : ''}
            `
          }
        </div>
      `;
      
      popupBanner.classList.remove('hidden');
    }

    function filterProducts() {
      let filtered = [...products];
      
      if (filters.category && filters.category !== 'all') {
        filtered = filtered.filter(p => p.Category === filters.category);
      }
      
      if (filters.price && filters.price !== 'all') {
        const [min, max] = filters.price.split('-').map(Number);
        if (filters.price === '100+') {
          filtered = filtered.filter(p => p.currentPrice >= 100);
        } else if (!isNaN(min) && !isNaN(max)) {
          filtered = filtered.filter(p => p.currentPrice >= min && p.currentPrice <= max);
        }
      }
      
      if (searchInput.value) {
        const query = searchInput.value.toLowerCase();
        filtered = filtered.filter(p => 
          p.Title.toLowerCase().includes(query) || 
          (p.Keywords && p.Keywords.toLowerCase().includes(query)) ||
          p.Id.toLowerCase().includes(query)
        );
      }
      
      switch (sort) {
        case 'price-low':
          filtered.sort((a, b) => a.currentPrice - b.currentPrice);
          break;
        case 'price-high':
          filtered.sort((a, b) => b.currentPrice - a.currentPrice);
          break;
        case 'discount-high':
          filtered.sort((a, b) => (b.discountPercentage || 0) - (a.discountPercentage || 0));
          break;
        case 'newest':
          filtered.sort((a, b) => new Date(b.Timestamp) - new Date(a.Timestamp));
          break;
        case 'rating':
          filtered.sort((a, b) => b.Rating - a.Rating);
          break;
      }
      
      filteredProducts = filtered;
      currentPage = 1;
      renderAllProducts();
      renderActiveFilters();
    }

    async function fetchProducts() {
      let cachedData;
      try {
        const stored = sessionStorage.getItem(CACHE_KEY);
        if (stored) {
          cachedData = JSON.parse(stored);
          if (!cachedData || !Array.isArray(cachedData.products)) {
            console.warn('Invalid cached data format, fetching new data');
            cachedData = null;
          }
        }
      } catch (e) {
        console.error('Error parsing cached data:', e);
        cachedData = null;
      }
      
      const now = Date.now();
      
      if (cachedData && now - cachedData.timestamp < CACHE_DURATION) {
        return cachedData.products;
      }
      
      try {
        const response = await fetch(SCRIPT_URL);
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        
        if (!Array.isArray(data)) {
          throw new Error('Expected an array of products, but received: ' + JSON.stringify(data));
        }
        
        const normalizedData = data.map(product => {
          const originalPrice = Number(product.OriginalPrice) || 0;
          const discountPrice = Number(product.DiscountPercentage) || originalPrice;
          return {
            ...product,
            Id: String(product.Id || product.ID || `product-${Math.random().toString(36).substr(2, 9)}`),
            Title: String(product.Title || ''),
            Keywords: String(product.Keywords || ''),
            ImageURLs: (product.ImageURLs || product.imageURLs || product.ImageUrl || product.imageUrl || '')
              .split(',')
              .map(url => url.trim())
              .filter(url => url),
            originalPrice: originalPrice,
            currentPrice: discountPrice,
            discountPercentage: originalPrice > 0 && discountPrice < originalPrice
              ? ((originalPrice - discountPrice) / originalPrice * 100).toFixed(2)
              : 0,
            Timestamp: product.Timestamp ? new Date(product.Timestamp) : new Date(),
            Rating: Math.min(5, Math.max(0, Number(product.Rating) || Math.random() * 4 + 1)),
            Banner: product.Banner || false,
            Pbanner: product.Pbanner || false
          };
        });
        
        sessionStorage.setItem(CACHE_KEY, JSON.stringify({
          products: normalizedData,
          timestamp: now
        }));
        
        return normalizedData;
      } catch (error) {
        console.error('Fetch error:', error);
        if (cachedData && Array.isArray(cachedData.products)) {
          return cachedData.products;
        }
        return [];
      }
    }

    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    async function loadProducts() {
      splashScreen.classList.remove('hidden');
      app.classList.add('hidden');
      errorState.classList.add('hidden');
      
      try {
        const data = await fetchProducts();
        products = shuffleArray(data);
        
        if (products.length === 0) {
          throw new Error('No products loaded');
        }
        
        bannerProduct = products.find(p => p.Banner === true) || null;
        
        if (bannerProduct) {
          heroBanner.classList.remove('hidden');
          bannerImage.src = bannerProduct.ImageURLs[0] || PLACEHOLDER_IMAGE;
          bannerImage.onerror = () => { bannerImage.src = PLACEHOLDER_IMAGE; };
          bannerTitle.textContent = bannerProduct.Title;
          //bannerDescription.textContent = bannerProduct.Description;
          
          if (bannerProduct.currentPrice === 0) {
            bannerPrice.textContent = 'Free';
            bannerPrice.className = 'text-xl font-bold text-green-600 mr-3';
            bannerDiscount.classList.add('hidden');
            bannerOriginalPrice.classList.add('hidden');
          } else {
            bannerPrice.textContent = formatPrice(bannerProduct.currentPrice);
            bannerPrice.className = 'text-xl font-bold text-purple-600 mr-3';
            if (bannerProduct.discountPercentage > 0) {
              bannerDiscount.textContent = `${bannerProduct.discountPercentage}% OFF`;
              bannerDiscount.classList.remove('hidden');
              bannerOriginalPrice.textContent = formatPrice(bannerProduct.originalPrice);
              bannerOriginalPrice.classList.remove('hidden');
            } else {
              bannerDiscount.classList.add('hidden');
              bannerOriginalPrice.classList.add('hidden');
            }
          }
        } else {
          heroBanner.classList.add('hidden');
        }
        
        categories = [...new Set(products.map(p => p.Category).filter(c => c))];
        
        categoryFilter.innerHTML = '<option value="all">All Categories</option>' + 
          categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
        
        mobileCategoryFilter.innerHTML = '<option value="all">All Categories</option>' + 
          categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
        
        if (products.length > 0) {
          latestProducts = [...products]
            .sort((a, b) => new Date(b.Timestamp) - new Date(a.Timestamp))
            .slice(0, Math.min(5, products.length));
        } else {
          latestProducts = [];
        }
        
        favorites = getFavorites();
        updateFavoritesCount();
        
        popupProduct = products.find(p => p.Pbanner === true) || null;
        
        filterProducts();
        
        splashScreen.classList.add('hidden');
        app.classList.remove('hidden');
        
        checkHash();
      } catch (error) {
        console.error('Error loading products:', error);
        splashScreen.classList.add('hidden');
        errorState.classList.remove('hidden');
      }
    }

    function checkHash() {
      const productId = window.location.hash.replace('#', '');
      if (productId) {
        const product = products.find(p => p.Id === productId);
        if (product) {
          viewProduct(product);
        } else {
          history.replaceState(null, null, window.location.pathname + window.location.search);
          if (!sessionStorage.getItem('bannerShown') && popupProduct) {
            renderPopupBanner();
            sessionStorage.setItem('bannerShown', 'true');
          }
        }
      } else {
        if (!sessionStorage.getItem('bannerShown') && popupProduct) {
          renderPopupBanner();
          sessionStorage.setItem('bannerShown', 'true');
        }
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      currentYear.textContent = new Date().getFullYear();
      
      loadProducts();

      heroBanner.addEventListener('click', () => {
        if (bannerProduct) {
          viewProduct(bannerProduct);
        }
      });
      
      let searchTimeout;
      searchInput.addEventListener('input', () => {
        clearSearch.classList.toggle('hidden', !searchInput.value);
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          filterProducts();
        }, 300);
      });
      
      clearSearch.addEventListener('click', () => {
        searchInput.value = '';
        clearSearch.classList.add('hidden');
        filterProducts();
      });
      
      categoryFilter.addEventListener('change', (e) => {
        filters.category = e.target.value;
        filterProducts();
      });
      
      sortSelect.addEventListener('change', (e) => {
        sort = e.target.value;
        filterProducts();
      });
      
      activeFilters.addEventListener('click', (e) => {
        const target = e.target.closest('.remove-filter') || e.target.closest('.remove-sort');
        if (target) {
          if (target.classList.contains('remove-filter')) {
            const filterType = target.getAttribute('data-filter');
            delete filters[filterType];
            categoryFilter.value = 'all';
            mobileCategoryFilter.value = 'all';
            filterProducts();
          } else if (target.classList.contains('remove-sort')) {
            sort = 'default';
            sortSelect.value = 'default';
            filterProducts();
          }
        }
      });
      
      clearAllFilters.addEventListener('click', () => {
        filters = {};
        sort = 'default';
        sortSelect.value = 'default';
        categoryFilter.value = 'all';
        mobileCategoryFilter.value = 'all';
        mobilePriceFilter.value = 'all';
        filterProducts();
      });
      
      favoritesButton.addEventListener('click', () => {
        renderFavorites();
        favoritesPanel.classList.remove('hidden');
      });
      
      mobileSearchButton.addEventListener('click', () => {
        mobileSearch.classList.remove('hidden');
      });
      
      closeMobileSearch.addEventListener('click', () => {
        mobileSearch.classList.add('hidden');
      });
      
      let mobileSearchTimeout;
      mobileSearchInput.addEventListener('input', () => {
        clearMobileSearch.classList.toggle('hidden', !mobileSearchInput.value);
        clearTimeout(mobileSearchTimeout);
        mobileSearchTimeout = setTimeout(() => {
          const query = mobileSearchInput.value.toLowerCase();
          const filtered = products.filter(p => 
            p.Title.toLowerCase().includes(query) || 
            (p.Keywords && p.Keywords.toLowerCase().includes(query)) ||
            p.Id.toLowerCase().includes(query)
          );
          
          if (filtered.length === 0) {
            mobileSearchResults.innerHTML = '<p class="text-center text-gray-500">No products found</p>';
          } else {
            mobileSearchResults.innerHTML = '<div class="grid grid-cols-3 gap-4"></div>';
            const container = mobileSearchResults.querySelector('div');
            renderProducts(filtered, container);
          }
        }, 300);
      });
      
      clearMobileSearch.addEventListener('click', () => {
        mobileSearchInput.value = '';
        clearMobileSearch.classList.add('hidden');
        mobileSearchResults.innerHTML = '<p class="text-center text-gray-500">Search for products</p>';
      });
      
      mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.remove('hidden');
      });
      
      closeMobileMenu.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
      });
      
      mobileCategoryFilter.addEventListener('change', (e) => {
        filters.category = e.target.value;
        categoryFilter.value = e.target.value;
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      mobilePriceFilter.addEventListener('change', (e) => {
        filters.price = e.target.value;
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      sortDefault.addEventListener('click', () => {
        sort = 'default';
        sortSelect.value = 'default';
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      sortPriceLow.addEventListener('click', () => {
        sort = 'price-low';
        sortSelect.value = 'price-low';
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      sortPriceHigh.addEventListener('click', () => {
        sort = 'price-high';
        sortSelect.value = 'price-high';
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      sortDiscountHigh.addEventListener('click', () => {
        sort = 'discount-high';
        sortSelect.value = 'discount-high';
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      sortNewest.addEventListener('click', () => {
        sort = 'newest';
        sortSelect.value = 'newest';
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      sortRating.addEventListener('click', () => {
        sort = 'rating';
        sortSelect.value = 'rating';
        filterProducts();
        mobileMenu.classList.add('hidden');
      });
      
      mobileFavoritesButton.addEventListener('click', () => {
        renderFavorites();
        mobileMenu.classList.add('hidden');
        favoritesPanel.classList.remove('hidden');
      });
      
      closeFavorites.addEventListener('click', () => {
        favoritesPanel.classList.add('hidden');
      });
      
      closeProductModal.addEventListener('click', () => {
        const scrollY = window.scrollY;
        productModal.classList.add('hidden');
        selectedProduct = null;
        history.replaceState(null, null, window.location.pathname + window.location.search);
        window.scrollTo(0, scrollY);
      });
      
      popupContent.addEventListener('click', () => {
        if (popupProduct) {
          viewProduct(popupProduct);
          popupBanner.classList.add('hidden');
        }
      });
      
      closePopupBanner.addEventListener('click', () => {
        popupBanner.classList.add('hidden');
      });
      
      refreshButton.addEventListener('click', () => {
        window.location.reload();
      });
      
      refreshButton2.addEventListener('click', () => {
        window.location.reload();
      });
      
      clearSearchFilter.addEventListener('click', () => {
        searchInput.value = '';
        clearSearch.classList.add('hidden');
        filters = {};
        sort = 'default';
        sortSelect.value = 'default';
        categoryFilter.value = 'all';
        mobileCategoryFilter.value = 'all';
        mobilePriceFilter.value = 'all';
        filterProducts();
      });
      
      window.addEventListener('hashchange', checkHash);
    });
  </script>
</body>
</html>